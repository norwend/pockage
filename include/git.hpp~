#pragma once

#include <fmt/core.h>
#include "git2.h"

class Git {
public:
    Git() {
	git_libgit2_init();
    }

    void init() {
	git_repository* repo = NULL;
	int error = git_repository_init(&repo, "/tmp/...", false);
	if (error < 0) {
	    const git_error* e = git_error_last();
	    fmt::print(stderr, "Error {}/{}: {}\n", error, e->klass, e->message);
	    exit(error);
	}
    }

    void clone(const std::string& url, const std::string& path) {
	git_repository* repo = NULL;
	int error = git_clone(&repo, url.c_str(), path.c_str(), NULL);
	if (error < 0) {
	    const git_error* e = git_error_last();
	    fmt::print(stderr, "Error {}/{}: {}\n", error, e->klass, e->message);
	    exit(error);
	}
    }
    
    ~Git() {
	git_libgit2_shutdown();
    }
};
